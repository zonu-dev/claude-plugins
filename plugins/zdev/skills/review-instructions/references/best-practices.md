# CLAUDE.md Best Practices Checklist

## 目次

1. [ファイル配置と階層](#1-ファイル配置と階層)
2. [構造とセクション](#2-構造とセクション)
3. [コンテンツ品質](#3-コンテンツ品質)
4. [サイズとパフォーマンス](#4-サイズとパフォーマンス)
5. [ルールファイルとの関係](#5-ルールファイルとの関係)
6. [アンチパターン](#6-アンチパターン)
7. [ファイルタイプ別チェック](#7-ファイルタイプ別チェック)

## 1. ファイル配置と階層

### ファイル種別と配置場所

| 種別 | 配置場所 | 用途 | 共有範囲 |
|------|----------|------|----------|
| プロジェクト共有 | `./CLAUDE.md` or `./.claude/CLAUDE.md` | チーム共有の指示 | チームメンバー（git管理） |
| プロジェクトルール | `./.claude/rules/*.md` | モジュール化されたトピック別指示 | チームメンバー（git管理） |
| プロジェクトローカル | `./CLAUDE.local.md` | 個人のプロジェクト固有設定 | 自分のみ（当該プロジェクト） |

### 配置チェック
- [ ] プロジェクトルートに配置されている（サブディレクトリにある場合はオンデマンド読み込み）
- [ ] git管理すべきファイルがgit管理されている
- [ ] `CLAUDE.local.md` が `.gitignore` に含まれている（個人設定の場合）

## 2. 構造とセクション

### 推奨セクション構成（プロジェクトレベル）

以下のセクションが適切に含まれているかチェックする。全てが必須ではなく、プロジェクトに関連するセクションのみ含めるべき。

- [ ] **Project Overview**: 技術スタック、アーキテクチャ概要
- [ ] **Commands**: ビルド、テスト、リント、デプロイのコマンド
- [ ] **Code Style**: デフォルトと異なるコーディング規約
- [ ] **Architecture**: アーキテクチャの決定事項、重要なパターン
- [ ] **File Structure**: ディレクトリ構成と各ディレクトリの役割
- [ ] **Testing**: テスト戦略、テストランナー、カバレッジ要件
- [ ] **Git Workflow**: ブランチ命名、コミットメッセージ形式、PR規約

### 構成品質
- [ ] セクションが重要度順に配置されている
- [ ] マークダウン見出し（`##`, `###`）で適切に構造化されている
- [ ] セクション間に適切な空行がある

## 3. コンテンツ品質

### 含めるべき内容
- [ ] Claudeが推測できないBashコマンド（ビルド、テスト、リント、デプロイ）
- [ ] 言語デフォルトと異なるコードスタイルのルール
- [ ] テスト方法と優先テストランナー
- [ ] リポジトリの慣例（ブランチ命名、PR規約）
- [ ] プロジェクト固有のアーキテクチャ決定
- [ ] 環境の注意点（必要な環境変数等）
- [ ] 非自明な挙動やよくある落とし穴

### 含めるべきでない内容
- [ ] コードを読めばわかる情報を含んでいない
- [ ] 標準的な言語規約を繰り返していない
- [ ] 詳細なAPIドキュメントを埋め込んでいない（リンクで参照すべき）
- [ ] 頻繁に変更される情報を含んでいない
- [ ] 長い説明やチュートリアルを含んでいない
- [ ] ファイル単位のコードベース解説を含んでいない
- [ ] 「きれいなコードを書く」のような自明な指示を含んでいない
- [ ] ユーザー向けドキュメント（セットアップ手順、インストール方法、使い方ガイド等）を含んでいない

### リトマステスト
- [ ] 各セクション・各行について「この行を削除するとClaudeが間違えるか？」を確認している
- [ ] 「No」の場合、そのコンテンツは削除候補である

### 具体性と実行可能性
- [ ] 各ルールが具体的でアクショナブルである
- [ ] 「適切に」「必要に応じて」のような曖昧な表現を避けている
- [ ] 判断基準が明確に示されている（「大きいファイル」ではなく「800行を超えるファイル」）
- [ ] コード例がある場合、実際に動作するコピペ可能なものである
- [ ] BAD/GOOD の対比例がある（アンチパターンを教える場合）

### コマンド記述
- [ ] ビルドコマンドが記載されている（Claudeが推測できない場合）
- [ ] テストコマンドが記載されている（単一テスト実行と全体実行の両方）
- [ ] リントコマンドが記載されている
- [ ] 各コマンドに簡潔な説明がある

### コードパターン
- [ ] コード例が5〜20行程度の適切な長さである
- [ ] 型シグネチャ・型ヒントが含まれている
- [ ] エラーハンドリングのパターンが示されている（該当する場合）
- [ ] プロジェクト固有のパターン（APIレスポンス形式等）が統一されている

### 環境変数
- [ ] 必須とオプションが区別されている
- [ ] 各変数に用途の説明がある
- [ ] サーバー専用の変数にその旨の注釈がある
- [ ] 実際の値やシークレットが含まれていない

## 4. サイズとパフォーマンス

### 行数ガイドライン

| 行数 | ルール適用率 | 判定 |
|------|-------------|------|
| 〜100行 | 最適 | 理想的 |
| 100〜200行 | 92%以上 | 良好 |
| 200〜400行 | 低下傾向 | 注意 |
| 400行超 | 71%以下 | 要削減 |

### チェック項目
- [ ] 200行以下が望ましい（推奨スイートスポット: 30〜100行）
- [ ] 重要なルールには「IMPORTANT」「YOU MUST」などの強調表現を使用している（Claudeが繰り返し違反する場合）
- [ ] 詳細な内容は `.claude/rules/` に分離している

## 5. ルールファイルとの関係

### 役割分担

| 内容 | 置き場 |
|------|--------|
| プロジェクト概要・技術スタック | `CLAUDE.md` |
| 主要コマンド一覧 | `CLAUDE.md` |
| コミットメッセージ規約 | `CLAUDE.md` |
| パッケージ間の依存方向 | `.claude/rules/`（常時適用） |
| 特定ドメインの設計制約 | `.claude/rules/`（パス指定） |
| レイヤー間の呼び出し規則 | `.claude/rules/`（パス指定） |
| ドメイン固有の知識 | `.claude/skills/`（オンデマンド） |

### チェック項目
- [ ] CLAUDE.mdが簡潔なルーティング役に留まっている（詳細はルールに分離）
- [ ] `.claude/rules/` と内容が重複していない
- [ ] `.claude/rules/` の内容と矛盾していない
- [ ] ルールファイルが存在する場合、CLAUDE.mdからの参照・説明がある
- [ ] 確定的に守るべきルールはhooksで強制している（CLAUDE.mdの指示は助言的）

## 6. アンチパターン

### 避けるべきこと
- [ ] **肥大化**: 400行を超えるCLAUDE.md → 重要なルールが埋もれて無視される
- [ ] **自明な情報**: Claudeが既に知っている標準的な言語規約の記述
- [ ] **陳腐化する情報**: 日付・バージョン番号・「現在は」等の時間依存表現
- [ ] **ファイル単位の解説**: コードベースの説明をファイルごとに列挙
- [ ] **コードの大量埋め込み**: 実際のソースコードの長い断片を埋め込み（リンクで参照すべき）
- [ ] **ルールとの重複**: `.claude/rules/` に書いてある内容の繰り返し
- [ ] **実値の埋め込み**: APIキー、パスワード、トークン等のシークレット
- [ ] **リンターで代替可能なルール**: ESLint/Prettier等で自動検証できるルールの記載
- [ ] **曖昧な指示**: 「コード品質に注意する」「パフォーマンスを意識する」のような非アクショナブルな指示
- [ ] **絶対パスのハードコード**: ユーザー固有のパス（`/Users/xxx/...`）の埋め込み
- [ ] **ユーザー向けドキュメント**: セットアップ手順、インストール方法、使い方ガイド等のClaude向けでない情報（READMEに書くべき内容）

## 7. ファイルタイプ別チェック

### プロジェクトレベル CLAUDE.md

**必須チェック**:
- [ ] プロジェクトの技術スタックが明記されている
- [ ] ビルド・テスト・リントのコマンドが記載されている
- [ ] プロジェクト固有の規約が具体的に記述されている
- [ ] ファイル構造セクションがある（または自明な構造である）

**推奨チェック**:
- [ ] Git workflow（ブランチ戦略、コミット規約）が記載されている
- [ ] 環境変数の説明がある
- [ ] テスト戦略が記載されている
- [ ] 新規参画メンバーへのオンボーディングに使える内容である

### CLAUDE.local.md

**必須チェック**:
- [ ] `.gitignore` に含まれている
- [ ] プロジェクトのCLAUDE.mdと矛盾していない

**推奨チェック**:
- [ ] 個人固有の環境設定に限定されている
- [ ] チームで共有すべき情報が含まれていない

## @import チェック

- [ ] `@path/to/file` 形式のインポートが使われている場合、参照先が存在する
- [ ] インポートの深さが5ホップ以内である
- [ ] コードブロック内のインポート記法が誤って評価されていない
- [ ] 外部インポート（初回の承認ダイアログが必要）が適切に管理されている

## Severity Levels

### Critical (必須修正)

- CLAUDE.mdが空または実質的に内容がない
- シークレット（APIキー、パスワード、トークン）が含まれている
- `.claude/rules/` との明確な矛盾がある
- `@import` のリンク先が存在しない

### Warning (推奨修正)

- 400行を超えている
- `.claude/rules/` との内容重複がある
- 自明な情報・標準的な言語規約が含まれている
- コマンドセクションが欠落している（推測困難なコマンドがある場合）
- 技術スタックの記述がない（プロジェクトレベルの場合）
- 曖昧で非アクショナブルな指示がある
- 陳腐化しやすい時間依存情報がある
- 絶対パスがハードコードされている
- リンターで代替可能なルールが記載されている

### Info (改善提案)

- より簡潔にできる箇所がある
- セクション構成の最適化が可能
- コード例の追加が有効な箇所がある
- ルールファイルへの分離で改善できる箇所がある
- 強調表現（IMPORTANT等）の追加が有効な箇所がある
- BAD/GOOD対比例の追加が有効な箇所がある
