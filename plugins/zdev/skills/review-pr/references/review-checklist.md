# PRレビューチェックリスト

## コード品質

### 可読性
- [ ] 変数名・関数名が意図を明確に表現しているか
- [ ] 関数が単一責任を持っているか（長すぎないか）
- [ ] ネストが深すぎないか（3段階以上は要注意）
- [ ] マジックナンバー・マジックストリングがないか
- [ ] コメントが必要な箇所に適切に記述されているか（過剰でないか）

### 保守性
- [ ] DRY原則に従っているか（重複コードがないか）
- [ ] 適切な抽象化レベルか（過剰な抽象化も問題）
- [ ] 既存のコードスタイル・パターンと一貫しているか
- [ ] 不要なコード（デバッグ用、コメントアウト）が残っていないか

## 正確性

### ロジック
- [ ] 分岐条件が正しいか（off-by-one、境界値）
- [ ] null/undefined/空値の処理が適切か
- [ ] 型の安全性が確保されているか
- [ ] 並行処理の競合状態がないか（race condition）

### エラーハンドリング
- [ ] 例外処理が適切か（広すぎるcatchがないか）
- [ ] エラーメッセージが有用か
- [ ] リソースの解放が確実か（finally、defer、using）
- [ ] 外部サービス障害時の振る舞いが定義されているか

## セキュリティ

### OWASP Top 10
- [ ] SQLインジェクション対策（パラメータバインディング）
- [ ] XSS対策（出力エスケープ）
- [ ] CSRF対策（トークン検証）
- [ ] パストラバーサル対策（入力バリデーション）
- [ ] コマンドインジェクション対策

### 認証・認可
- [ ] 認証チェックが適切か
- [ ] 認可チェック（権限確認）が漏れていないか
- [ ] セッション管理が安全か

### データ保護
- [ ] シークレット（APIキー、パスワード）がハードコードされていないか
- [ ] ログに機密情報が出力されていないか
- [ ] 個人情報の取り扱いが適切か

## パフォーマンス

### データベース
- [ ] N+1クエリが発生していないか
- [ ] 適切なインデックスが使用されているか
- [ ] 不要なデータの取得がないか（SELECT *）
- [ ] トランザクションの範囲が適切か

### メモリ・CPU
- [ ] メモリリークの可能性がないか
- [ ] 不要なオブジェクト生成がないか
- [ ] ループ内で重い処理を行っていないか
- [ ] キャッシュの活用が適切か

### ネットワーク
- [ ] 不要なAPI呼び出しがないか
- [ ] バッチ処理の検討がされているか
- [ ] タイムアウト設定が適切か

## テスト

### カバレッジ
- [ ] 新規コードに対するテストが追加されているか
- [ ] エッジケースのテストがあるか
- [ ] エラーケースのテストがあるか
- [ ] 既存テストが壊れていないか

### テスト品質
- [ ] テストが実装の詳細に依存しすぎていないか
- [ ] テスト名が意図を明確に表現しているか
- [ ] モック/スタブの使用が適切か

## 設計

### アーキテクチャ
- [ ] 既存のアーキテクチャパターンに従っているか
- [ ] 関心の分離が適切か
- [ ] 依存関係の方向が正しいか
- [ ] 変更の影響範囲が適切に限定されているか

### API設計（該当する場合）
- [ ] RESTful原則に従っているか
- [ ] リクエスト/レスポンスの形式が一貫しているか
- [ ] エラーレスポンスが統一されているか
- [ ] 後方互換性が維持されているか

## 重大度の判定基準

| 重大度 | 基準 | 例 |
|--------|------|-----|
| **Critical** | マージ前に必ず修正が必要 | セキュリティ脆弱性、データ損失、クラッシュ |
| **Important** | 修正を強く推奨 | バグの可能性、パフォーマンス問題、テスト不足 |
| **Suggestion** | 改善するとより良い | リファクタリング、命名改善、ドキュメント |
| **Positive** | 良い実装 | 適切な設計判断、きれいなコード |
