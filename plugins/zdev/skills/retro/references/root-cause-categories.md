# 根本原因カテゴリ

スキル・ルールの問題を 8 つのカテゴリに分類し、それぞれに対応する改善パターンを定義する。

---

## カテゴリ一覧

| # | カテゴリ | 概要 | 典型的な症状 |
|---|---------|------|------------|
| 1 | ルール欠如 | 必要なルールが書かれていない | 毎回同じ指摘を受ける、属人的な判断になる |
| 2 | ルール曖昧 | ルールはあるが解釈の幅が大きい | 人によって結果が異なる、「適切に」等の曖昧表現 |
| 3 | バリデーション不足 | 間違いに気づく仕組みがない | 最終成果物で初めて問題が発覚する |
| 4 | デフォルト不適切 | デフォルト値が実態に合わない | 毎回同じ値を上書きしている、初回が常に失敗する |
| 5 | 例示不足 | 良い例・悪い例がない | 正解がわからず手探りになる、品質にばらつき |
| 6 | スコープ不足 | 特定条件の考慮が漏れている | 通常は動くが特定パターンで壊れる |
| 7 | ワークフロー順序 | チェックのタイミングが不適切 | 手戻りが大きい、後工程で検出される |
| 8 | 参照ファイル不整合 | 参照ファイル間で矛盾がある | ファイル A と B で異なる基準が書かれている |

---

## カテゴリ別 改善パターン

### 1. ルール欠如

**原因**: 想定していなかったケースが発生し、対応するルールが存在しない。

**改善パターン**:
- SKILL.md のワークフロー該当ステップに明示的ルールを追加
- 頻出パターンなら references/ にチェックリストとして分離

**改善例**:

| Before | After |
|--------|-------|
| (ルールなし) | `コードブロックは 1 スライドあたり最大 12 行とする` |

### 2. ルール曖昧

**原因**: 「適切に」「必要に応じて」等の曖昧な表現でルールが書かれている。

**改善パターン**:
- 具体的な数値・条件・閾値に書き換える
- 判定基準をテーブルで明示する

**改善例**:

| Before (NG) | After (OK) |
|-------------|-----------|
| 適切な長さにする | 全角 38 文字以内にする |
| 必要に応じて図を追加 | テキストのみのスライドが 3 枚連続したら図を追加 |

### 3. バリデーション不足

**原因**: ワークフロー中に成果物を検証するステップがない。

**改善パターン**:
- ワークフローにチェックポイント（lint、自己レビュー、ツール実行）を追加
- 自動検出可能な項目は lint スクリプトに組み込む

**改善例**:

| Before | After |
|--------|-------|
| ステップ 5 で完了 | ステップ 5 の後に `npm run marp:lint` を実行して検証 |

### 4. デフォルト不適切

**原因**: 初期設定の値が実際の使用パターンと乖離している。

**改善パターン**:
- 実際の使用実績からデフォルト値を見直す
- よく使うパターンをデフォルトに昇格させる

**改善例**:

| Before (NG) | After (OK) |
|-------------|-----------|
| `theme: default` | `theme: tech-scrapbook` |
| フッター: なし | フッター: `© 2024 プロジェクト名` |

### 5. 例示不足

**原因**: ルールはあるが具体例がなく、正解のイメージが掴めない。

**改善パターン**:
- BAD / GOOD の対比例を追加する
- references/ に例示集ファイルを作成する

**改善例**:

```markdown
## 見出しの書き方

| BAD | GOOD | 理由 |
|-----|------|------|
| アーキテクチャ | レイヤード構成で責務を分離する | 何がわかるか伝わる |
| まとめ | 3 つの設計原則を振り返る | 具体的な内容が予測できる |
```

### 6. スコープ不足

**原因**: 通常パターンは考慮されているが、エッジケースへの対応が漏れている。

**改善パターン**:
- 条件分岐を追加する（「〜の場合は〜する」）
- エッジケースを references/ にパターン集として整理する

**改善例**:

| Before | After |
|--------|-------|
| 画像は `![](path)` で埋め込む | 画像は `![](path)` で埋め込む。SVG の場合は `<img>` タグで `width` を指定する |

### 7. ワークフロー順序

**原因**: チェックが遅すぎて手戻りが大きい、または早すぎて情報不足のまま判断している。

**改善パターン**:
- チェックポイントをワークフローの適切な位置に移動する
- 早期フィードバックループを設ける

**改善例**:

| Before | After |
|--------|-------|
| 全スライド完成後に lint | 3 スライドごとに lint を実行 |
| 最後にユーザー確認 | 構成確定時とデザイン確定時の 2 回確認 |

### 8. 参照ファイル不整合

**原因**: 複数のファイルで同じ概念を異なる基準で記述している。

**改善パターン**:
- 正（canonical）を 1 箇所に決め、他は参照リンクにする
- 重複定義を削除し、単一の情報源（Single Source of Truth）にする

**改善例**:

| Before (NG) | After (OK) |
|-------------|-----------|
| content-limits.md: 上限 10 行 / review-checklist.md: 上限 15 行 | content-limits.md: 上限 12 行（正）/ review-checklist.md: 「上限は content-limits.md を参照」 |

---

## 使い方

Phase 1（問題の把握）でユーザーが問題を言語化しにくい場合、**カテゴリ一覧** の「典型的な症状」を提示して心当たりを尋ねる。

Phase 3（根本原因の分析）で問題を分類する際、このファイルのカテゴリと改善パターンを参照して具体的な改善案を組み立てる。

1 つの問題が複数カテゴリに該当することがある。その場合は全て列挙し、優先度の高いものから改善する。
