---
description: Claude Codeのルールファイル（.claude/rules/）をベストプラクティスに基づいてレビューする。ルールの品質チェック、構造の検証、スコープの妥当性評価、改善提案を行う。「ルールをレビューして」「rulesを検証」「ルールの品質チェック」などのリクエストで起動する。
argument-hint: "[ルールファイル名またはパス]"
---

# ルールレビュー

公式ベストプラクティスに基づいて `.claude/rules/` のルールファイルをレビューし、改善提案を行う。

## レビューワークフロー

### ステップ1: 対象ルールの特定

レビュー対象を特定する：
- ユーザーがファイルパスを直接指定 → そのファイルをレビュー
- 指定なし → `.claude/rules/` 配下の全 `.md` ファイルを一括レビュー
- 複数ある場合はファイル一覧を提示し、全件 or 選択をユーザーに確認

### ステップ2: 読み込みと分析

1. 対象のルールファイルを完全に読み込む
2. [best-practices.md](references/best-practices.md) でチェックリストを確認
3. プロジェクトの `CLAUDE.md` も読み込み、重複や矛盾がないか確認
4. YAMLフロントマターを解析（`paths` / `description` / `globs` / `alwaysApply`）
5. ボディコンテンツの構造と品質を分析

### ステップ3: ベストプラクティスとの照合

各カテゴリを評価：

**スコープチェック**
- フロントマター形式が正しいか（`paths` のグロブパターン）
- スコープが広すぎ / 狭すぎないか
- 常時適用すべきルールにフロントマターがないか（逆も）

**コンテンツチェック**
- 1ファイル1関心事になっているか
- 指示が具体的でアクショナブルか
- `CLAUDE.md` と内容が重複していないか
- チェックリスト形式を活用しているか

**構造チェック**
- ファイル名が内容を端的に表しているか
- マークダウン見出しで適切に構造化されているか
- 簡潔か（目安: 100行以下）

**アンチパターン検出**
- 陳腐化しやすいコード例の埋め込み
- 曖昧で非アクショナブルな指示
- 実在しないパスへのグロブマッチ
- 他ルールとの内容重複

**ルール化妥当性チェック**（[best-practices.md §7](references/best-practices.md) 参照）
- ルールの内容がコードから自明でないか（非自明性）
- 違反時の影響度が十分に高いか
- 自動検証ツールで代替できないか
- コンテキストコストに見合う価値があるか

### ステップ4: レビューレポート生成

出力形式：

```markdown
# ルールレビューレポート

## サマリー
- 対象: {ファイル数}件
- 総合評価: {PASS | NEEDS_IMPROVEMENT | CRITICAL_ISSUES}
- Critical: {件数} / Warning: {件数} / Info: {件数}

## ファイル別レビュー

### {filename.md}
- スコープ: {常時適用 | パス指定（対象パス概要）}
- 評価: {PASS | NEEDS_IMPROVEMENT | CRITICAL_ISSUES}

#### 指摘事項
{重大度順に指摘をリスト}

## ルール化妥当性
{各ルールが5基準（非自明性・違反影響度・判断分岐頻度・自動検証補完・コンテキストコスト）を満たしているかの評価}

## 全体的な改善提案
{ルールファイル群全体に対する構造的な提案}
```

### ステップ5: インタラクティブな改善

レポート提示後：
1. ユーザーに修正を希望するか確認
2. Critical 問題を優先的に修正
3. 段階的に修正を適用
4. 各修正後に再検証

## 重大度分類

### Critical
ルールが意図通りに機能しない問題：
- `paths` のグロブパターンが不正（マッチするファイルが存在しない）
- `CLAUDE.md` との矛盾（相反する指示）
- 空または実質的に内容がないルールファイル
- フロントマターの構文エラー（YAMLとして解析できない）

### Warning
ルールの効果を低下させる問題：
- `CLAUDE.md` との内容重複
- スコープが広すぎる（ほぼ全ファイルにマッチ → 常時適用にすべき）
- 曖昧で非アクショナブルな指示
- 1ファイルに複数の関心事が混在
- ファイル名と内容の不一致

### Info
改善の機会：
- より簡潔にできる箇所
- チェックリスト形式への変換で改善する箇所
- ファイル分割や統合の提案

## レビューセッション例

ユーザー: 「rulesをレビューして」（全件レビュー）

```
1. .claude/rules/ 配下の全 .md ファイルを列挙
2. 各ファイルを読み込み
3. CLAUDE.md を読み込み（重複チェック用）
4. best-practices.md に照らして分析
5. 日本語でレポート生成
6. 修正を提案
```

ユーザー: 「billing.md をレビューして」（単一ファイルレビュー）

```
1. .claude/rules/billing.md を読み込み
2. CLAUDE.md を読み込み（重複チェック用）
3. best-practices.md に照らして分析
4. 日本語でレポート生成
5. 修正を提案
```

**レポート出力例**:
```markdown
# ルールレビューレポート

## サマリー
- 対象: 3件
- 総合評価: NEEDS_IMPROVEMENT
- Critical: 1 / Warning: 2 / Info: 1

## ファイル別レビュー

### billing.md
- スコープ: パス指定（**/billing/**, **/Paywall* 等）
- 評価: PASS

### srs.md
- スコープ: パス指定（**/srs*, **/study* 等）
- 評価: NEEDS_IMPROVEMENT

#### 指摘事項
- [Warning] CLAUDE.md のアーキテクチャ要点にも SRS の言及あり。役割を明確に分離すべき

### api-routes.md
- スコープ: パス指定（backend/api/src/routes/**)
- 評価: CRITICAL_ISSUES

#### 指摘事項
- [Critical] paths に指定された `backend/api/src/routes/**` にファイルが存在しない

## 全体的な改善提案
- パッケージ間の依存方向ルールが未定義。`dependency-boundaries.md`（常時適用）の追加を推奨
```
